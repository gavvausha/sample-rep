<?php
function file_size($size) {
	if($size > 1073741824) {
		$size = round(($size/1048576),2).' GB';
	} else if($size > 1048576) {
		$size = round(($size/1048576),2).' MB';
	} else if($size > 1024) {
		$size = round(($size/1024),2).' KB';
	} else {
		$size = $size.' Bytes';
	}
	return $size;
}

$doc  = new DOMDocument('1.0');
// $doc->formatOutput = true;
$root = $doc->createElement('root');
$root = $doc->appendChild($root);
//$path = 'C:\wamp\www\usha\2#task';
$path = '/var/www/html/usha/2#task';
$it   = new RecursiveDirectoryIterator($path);
echo "<b>LIST OF FOLDERS & FILES OF CURRENT DIRECTORY:</b><br /><br />";
echo "<b>FOLDERS   : </b><br /><br />";

	foreach($it as $file) {
		if($file->isDir()) {
			$folder = $it->getSubPathName();
			$title  = $doc->createElement('folder');
			$title  = $root->appendChild($title);
			$text   = $doc->createTextNode($folder);
			$text   = $title->appendChild($text);
			$folder = $it->getSubPathName();$dit=new RecursiveDirectoryIterator($it);
			echo  "&nbsp;&nbsp;&nbsp;+ ".$folder. "<br />";
			foreach($dit as $file)  {   
				echo "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;---".$dit->getFilename()."<br />";
				$s       = file_size(filesize($file));
				$d       = date ("d.m.Y", filemtime($file));
				$date    = filemtime($file);
				$sub     = $doc->createElement('file');
				$subf    = $title->appendChild($sub);
				$stext   = $doc->createTextNode($dit->getFilename());
				$stext   = $sub->appendChild($stext);
				$size    = $doc->createAttribute('Size');
				$sub->appendChild($size);
				$sizeval = $doc->createTextNode($s);
				$size->appendChild($sizeval);
				$date    = $doc->createAttribute("Date");
				$sub->appendChild($date);
				$dateval = $doc->createTextNode($d);
				$date->appendChild($dateval);
			}
		}
	}
echo "<br /><br />";
echo "<b>FILES    : </b><br /><br />";
	foreach($it as $file) {
		if($file->isfile()) {
			$d       = date ("d.m.Y", filemtime($file));
			$s       = file_size(filesize($file));
			$title   = $doc->createElement('file');
			$title   = $root->appendChild($title);
			$text    = $doc->createTextNode($it->getFilename());
			$text    = $title->appendChild($text);
			$size    = $doc->createAttribute("Size");
			$title->appendChild($size);
			$sizeval = $doc->createTextNode($s);
			$size->appendChild($sizeval);
			$date    = $doc->createAttribute("Date");
			$title->appendChild($date);
			$dateval = $doc->createTextNode($d);
			$date->appendChild($dateval);
			echo "&nbsp;&nbsp;&nbsp;--".$it->getFilename() ."<br />";
		}
	}
echo "<br />".'Wrote: ' . $doc->save("outputroot.xml") . ' bytes'; 
?>
